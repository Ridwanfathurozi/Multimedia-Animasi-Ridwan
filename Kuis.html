<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis Aljabar Seru! - SMP</title>
    <!-- Memuat Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <!-- Memuat font Inter dari Google Fonts --><link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        /* Mengatur font default ke Inter */
        body {
            font-family: 'Inter', sans-serif;
            /* Style background baru */
            background-image: 
                /* Lapisan gradien warna hijau-kuning untuk overlay */
                linear-gradient(to bottom right, rgba(144, 238, 144, 0.7), rgba(255, 255, 0, 0.7)),
                /* Gambar kota sebagai background. Anda bisa ganti URL ini dengan gambar kota yang Anda inginkan */
                url('https://images.unsplash.com/photo-1582234027787-897c8d9c228d?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTQzMjF8MHwxfHNlYXJjaHwyMHx8Y2l0eXNjcGFwZXxlbnwwfHx8fDE3MDY5MzQzNTh8MA&ixlib=rb-4.0.3&q=80&w=1080');
            background-size: cover; /* Menutupi seluruh area */
            background-position: center; /* Memusatkan gambar */
            background-attachment: fixed; /* Membuat background tetap saat scroll */
            min-height: 100vh; /* Pastikan body setinggi viewport */
            display: flex; /* Untuk memusatkan konten */
            align-items: center; /* Untuk memusatkan konten */
            justify-content: center; /* Untuk memusatkan konten */
            padding: 1rem; /* Padding agar tidak terlalu mepet tepi */
        }

        /* Style kustom untuk tombol jawaban yang benar */
        .correct-answer {
            background-color: #16a34a !important; /* Tailwind green-600 */
            color: white !important;
            border-color: #15803d !important; /* Tailwind green-700 */
        }
        /* Style kustom untuk tombol jawaban yang salah */
        .wrong-answer {
            background-color: #dc2626 !important; /* Tailwind red-600 */
            color: white !important;
            border-color: #b91c1c !important; /* Tailwind red-700 */
        }
        /* Efek hover yang lebih baik untuk tombol opsi */
        .option-btn:not(:disabled):hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgb(34,193,195);
        }

        /* === PERBAIKAN: === */
        /* Tambahkan ini agar layar kuis (start, quiz, results) */
        /* muncul di atas animasi background (.box) */
        #start-screen, #quiz-screen, #results-screen {
            position: relative;
            z-index: 10;
        }
        /* === AKHIR PERBAIKAN === */

        /* Menyesuaikan warna teks konten agar tetap terbaca di background baru */
        #app {
            background-color: rgba(14, 45, 89, 0.9); /* Sedikit lebih transparan dari gray-800 */
            border-radius: 1.5rem; /* rounded-2xl */
            box-shadow: 0 20px 25px -5px rgb(34,193,195), 0 10px 10px -5px rgb(34,193,195); /* shadow-2xl */
            padding: 2rem; /* p-8 */
            max-width: 48rem; /* max-w-2xl */
            /* Tambahkan overflow: hidden dan position: relative jika .box ingin di dalam #app */
            /* Tapi solusi di atas (z-index di screen) lebih aman */
        }

        .box {
            position: fixed; /* Tetap di background saat scroll */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0; /* Di belakang konten (sekarang konten punya z-index: 10) */
            overflow: hidden; /* Agar kotak tidak keluar layar */
        }
        .box div {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.15);
            bottom: -150px; /* Mulai dari bawah layar */
            
            /* Menerapkan animasi */
            animation: animateBox 25s linear infinite;
        }

        /* Pengaturan individu untuk setiap kotak */
        .box div:nth-child(1) { left: 25%; width: 80px; height: 80px; animation-delay: 0s; }
        .box div:nth-child(2) { left: 10%; width: 20px; height: 20px; animation-delay: 2s; animation-duration: 12s; }
        .box div:nth-child(3) { left: 70%; width: 20px; height: 20px; animation-delay: 4s; }
        .box div:nth-child(4) { left: 40%; width: 60px; height: 60px; animation-delay: 0s; animation-duration: 18s; }
        .box div:nth-child(5) { left: 65%; width: 20px; height: 20px; animation-delay: 0s; }
        .box div:nth-child(6) { left: 75%; width: 110px; height: 110px; animation-delay: 3s; }
        .box div:nth-child(7) { left: 35%; width: 150px; height: 150px; animation-delay: 7s; }
        .box div:nth-child(8) { left: 50%; width: 25px; height: 25px; animation-delay: 15s; animation-duration: 45s; }
        .box div:nth-child(9) { left: 20%; width: 15px; height: 15px; animation-delay: 2s; animation-duration: 35s; }
        .box div:nth-child(10) { left: 85%; width: 150px; height: 150px; animation-delay: 0s; animation-duration: 11s; }
        .box div:nth-child(11) { left: 5%; width: 40px; height: 40px; animation-delay: 5s; }
        .box div:nth-child(12) { left: 90%; width: 50px; height: 50px; animation-delay: 8s; }

        /* Keyframes untuk animasi */
        @keyframes animateBox {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
                border-radius: 0;
            }
            100% {
                transform: translateY(-1000px) rotate(720deg);
                opacity: 0;
                border-radius: 50%;
            }
        }

    </style>
</head>
<body class="text-white"> <!-- Hapus kelas bg-gray-900 dari body -->
    <!-- Kontainer Utama Aplikasi -->
    <div id="app" class="w-full mx-auto">

        <!-- === BACKGROUND ANIMASI === -->
        <div class="box">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>

        <!-- 1. Layar Mulai (Start Screen) -->
        <div id="start-screen" class="p-8 sm:p-12 text-center transition-all duration-300">
            <h1 class="text-3xl sm:text-5xl font-extrabold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-blue-300 to-purple-400">
                Kuis Aljabar Seru!
            </h1>
            <p class="text-lg sm:text-xl text-gray-200 mb-8">
                Uji pemahamanmu tentang dasar-dasar aljabar SMP. Siap?
            </p>
            <button id="start-btn" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-bold py-3 px-10 rounded-lg text-xl shadow-lg transform hover:scale-105 transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-blue-400">
                Mulai Kuis!
            </button>
        </div>

        <!-- 2. Layar Kuis (Quiz Screen) - Awalnya tersembunyi -->
        <div id="quiz-screen" class="hidden p-6 sm:p-8 w-full transition-all duration-300">
            <!-- Header Kuis: Info Soal dan Skor -->
            <div class="flex justify-between items-center text-gray-300 text-sm mb-4">
                <div>
                    <span>Soal </span>
                    <span id="question-number" class="font-bold text-lg text-white">1</span>
                    <span> dari </span>
                    <span id="total-questions" class="font-bold text-lg text-white">10</span>
                </div>
                <div class="bg-gray-700 px-3 py-1 rounded-full">
                    <span class="font-semibold">Skor: </span>
                    <span id="score" class="font-bold text-lg text-white">0</span>
                </div>
            </div>

            <!-- Garis Progres (Opsional, tapi keren) -->
            <div class="w-full bg-gray-700 rounded-full h-2.5 mb-6">
                <div id="progress-bar" class="bg-blue-500 h-2.5 rounded-full transition-all duration-300" style="width: 10%"></div>
            </div>

            <!-- Pertanyaan -->
            <h2 id="question-text" class="text-xl sm:text-2xl font-semibold my-6 min-h-[60px] text-gray-100">
                Pertanyaan akan dimuat di sini...
            </h2>

            <!-- Pilihan Jawaban -->
            <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Tombol pilihan akan di-generate oleh JavaScript -->
            </div>

            <!-- Umpan Balik (Feedback) -->
            <div id="feedback" class="text-lg font-semibold mt-5 text-center h-8">
                <!-- Umpan balik benar/salah muncul di sini -->
            </div>

            <!-- Tombol Lanjut -->
            <button id="next-btn" class="hidden w-full mt-6 bg-gray-700 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-lg text-lg shadow-lg transform hover:scale-105 transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-blue-400">
                Lanjut
            </button>
        </div>

        <!-- 3. Layar Hasil (Results Screen) - Awalnya tersembunyi -->
        <div id="results-screen" class="hidden p-8 sm:p-12 text-center transition-all duration-300">
            <h1 class="text-3xl sm:text-4xl font-extrabold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-green-300 to-teal-400">
                Kuis Selesai!
            </h1>
            <p class="text-xl text-gray-200 mb-2">Skor akhir kamu:</p>
            <div id="final-score" class="text-7xl font-extrabold text-white my-4">
                0
            </div>
            <p class="text-lg text-gray-200 mb-8">
                Kamu berhasil menjawab 
                <span id="correct-count" class="font-bold text-green-400">0</span> 
                dari 
                <span id="total-count" class="font-bold text-white">0</span> 
                soal dengan benar.
            </p>
            <div id="result-message" class="text-xl font-semibold mb-8"></div>
            <button id="restart-btn" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-bold py-3 px-10 rounded-lg text-xl shadow-lg transform hover:scale-105 transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-blue-400">
                Ulangi Kuis
            </button>
        </div>
    </div>
    

    <script>
        // --- 1. SELEKSI ELEMEN DOM ---
        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');

        const startBtn = document.getElementById('start-btn');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');

        const questionNumberEl = document.getElementById('question-number');
        const totalQuestionsEl = document.getElementById('total-questions');
        const scoreEl = document.getElementById('score');
        const progressBar = document.getElementById('progress-bar');
        
        const questionTextEl = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const feedbackEl = document.getElementById('feedback');

        const finalScoreEl = document.getElementById('final-score');
        const correctCountEl = document.getElementById('correct-count');
        const totalCountEl = document.getElementById('total-count');
        const resultMessageEl = document.getElementById('result-message');

        // --- 2. PENGATURAN & STATE KUIS ---
        const TOTAL_QUESTIONS = 10; // Tentukan jumlah soal per kuis
        let currentQuestionIndex = 0;
        let score = 0;
        let selectedAnswer = null;
        let currentGeneratedQuestion = null; // Menyimpan data soal yang sedang aktif

        // --- 3. FUNGSI HELPERS ---

        /**
         * Menghasilkan angka integer acak antara min dan max (inklusif).
         * @param {number} min - Angka minimal
         * @param {number} max - Angka maksimal
         * @param {number[]} exclude - Array angka yang tidak boleh dipilih
         * @returns {number} Angka acak
         */
        function getRandomInt(min, max, exclude = []) {
            let num;
            do {
                num = Math.floor(Math.random() * (max - min + 1)) + min;
            } while (exclude.includes(num));
            return num;
        }

        /**
         * Mengacak urutan elemen dalam sebuah array (Fisher-Yates shuffle).
         * @param {any[]} array - Array yang ingin diacak
         * @returns {any[]} Array baru dengan urutan acak
         */
        function shuffleArray(array) {
            let newArr = [...array];
            for (let i = newArr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArr[i], newArr[j]] = [newArr[j], newArr[i]];
            }
            return newArr;
        }

        // --- 4. GENERATOR SOAL ---

        /**
         * Template 1: Membuat soal "tentukan variabel".
         */
        function generateVariableQuestion() {
            const vars = shuffleArray(['x', 'y', 'z', 'a', 'b', 'c', 'p', 'q']);
            const v1 = vars[0];
            const v2 = vars[1];
            const c1 = getRandomInt(2, 9);
            const c2 = getRandomInt(2, 9);
            const constant = getRandomInt(-9, 9, [0]);
            
            const question = `Pada bentuk aljabar \`${c1}${v1} + ${c2}${v2} ${constant > 0 ? '+' : ''} ${constant}\`, yang merupakan variabel adalah...`;
            const correct = `\`${v1}\` dan \`${v2}\``;
            const options = [
                correct,
                `\`${c1}\` dan \`${c2}\``,
                `\`${constant}\``,
                `\`${c1}${v1}\` dan \`${c2}${v2}\``
            ];
            
            const shuffledOptions = shuffleArray(options);
            const answerIndex = shuffledOptions.indexOf(correct);

            return { question, options: shuffledOptions, answer: answerIndex };
        }

        /**
         * Template 2: Membuat soal "tentukan koefisien".
         */
        function generateCoefficientQuestion() {
            const vars = shuffleArray(['x', 'y', 'a', 'p']);
            const v = vars[0];
            const c1 = getRandomInt(2, 9); // Koefisien suku kuadrat
            const c2 = getRandomInt(-9, 9, [0]); // Koefisien suku linear (jawaban)
            const c3 = getRandomInt(-9, 9, [0]); // Konstanta
            
            // Format suku linear agar rapi (misal: + 1x -> + x, -1x -> -x)
            let term_c2 = '';
            if (c2 === 1) term_c2 = `+ ${v}`;
            else if (c2 === -1) term_c2 = `- ${v}`;
            else if (c2 > 1) term_c2 = `+ ${c2}${v}`;
            else term_c2 = `${c2}${v}`; // c2 negatif

            const question = `Koefisien dari \`${v}\` pada bentuk aljabar \`${c1}${v}¬≤ ${term_c2} ${c3 > 0 ? '+' : ''} ${c3}\` adalah...`;
            const correct = `\`${c2}\``;
            const options = [
                correct,
                `\`${c1}\``,
                `\`${c3}\``,
                `\`${getRandomInt(-9, 9, [0, c1, c2, c3])}\``
            ];
            
            const shuffledOptions = shuffleArray(options);
            const answerIndex = shuffledOptions.indexOf(correct);

            return { question, options: shuffledOptions, answer: answerIndex };
        }

        /**
         * Template 3: Membuat soal "sederhanakan bentuk aljabar".
         */
        function generateSimplificationQuestion() {
            const c1 = getRandomInt(2, 9);
            const c2 = getRandomInt(2, 9);
            const c3 = getRandomInt(-8, 8, [0, -c1]); // c1 + c3 tidak boleh 0
            const c4 = getRandomInt(-8, 8, [0, -c2]); // c2 + c4 tidak boleh 0
            
            const q_c3 = (c3 > 0) ? `+ ${c3}x` : `- ${Math.abs(c3)}x`;
            const q_c4 = (c4 > 0) ? `+ ${c4}y` : `- ${Math.abs(c4)}y`;

            const question = `Bentuk sederhana dari \`${c1}x + ${c2}y ${q_c3} ${q_c4}\` adalah...`;
            
            const ans_x = c1 + c3;
            const ans_y = c2 + c4;
            
            // Format jawaban agar rapi (misal: 2x + 1y -> 2x + y)
            const ans_x_str = (ans_x === 1) ? 'x' : (ans_x === -1) ? '-x' : `${ans_x}x`;
            const ans_y_str = (ans_y === 1) ? '+ y' : (ans_y === -1) ? '- y' : (ans_y > 0) ? `+ ${ans_y}y` : `- ${Math.abs(ans_y)}y`;
            
            const correct = `\`${ans_x_str} ${ans_y_str}\``;
            
            // Buat pengecoh
            const dist1_x = c1 - c3;
            const dist1_y = c2 - c4;
            const dist1 = `\`${dist1_x}x ${dist1_y > 0 ? '+' : ''} ${dist1_y}y\``;

            const dist2 = `\`${ans_x}x ${ans_y > 0 ? '-' : '+'} ${Math.abs(ans_y)}y\``;
            const dist3 = `\`${ans_y}x + ${ans_x}y\``;
            
            const options = [correct, dist1, dist2, dist3];
            
            const shuffledOptions = shuffleArray(options);
            const answerIndex = shuffledOptions.indexOf(correct);

            return { question, options: shuffledOptions, answer: answerIndex };
        }

        /**
         * Template 4: Membuat soal "selesaikan persamaan linear".
         */
        function generateEquationQuestion() {
            const a = getRandomInt(2, 5);
            const b = getRandomInt(1, 10);
            const answer = getRandomInt(2, 6); // Jawaban (nilai n)
            
            const c = (a * answer) + b; // (2 * 3) + 5 = 11 -> 2n + 5 = 11

            const question = `Jika \`${a}n + ${b} = ${c}\`, maka nilai \`n\` adalah...`;
            const correct = `\`${answer}\``;
            const options = [
                correct,
                `\`${answer + 1}\``,
                `\`${answer - 1}\``,
                `\`${answer + getRandomInt(2, 4)}\``
            ];

            const shuffledOptions = shuffleArray(options);
            const answerIndex = shuffledOptions.indexOf(correct);

            return { question, options: shuffledOptions, answer: answerIndex };
        }

        // Daftar semua generator soal
        const questionGenerators = [
            generateVariableQuestion,
            generateCoefficientQuestion,
            generateSimplificationQuestion,
            generateEquationQuestion
        ];

        /**
         * Memilih satu generator secara acak dan membuat soal.
         */
        function generateQuestion() {
            const randomIndex = getRandomInt(0, questionGenerators.length - 1);
            const generator = questionGenerators[randomIndex];
            return generator();
        }

        // --- 5. FUNGSI UTAMA KUIS ---

        function startGame() {
            startScreen.classList.add('hidden');
            resultsScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');

            currentQuestionIndex = 0;
            score = 0;
            scoreEl.innerText = score;
            totalQuestionsEl.innerText = TOTAL_QUESTIONS;

            loadQuestion();
        }

        function loadQuestion() {
            selectedAnswer = null;
            nextBtn.classList.add('hidden');
            feedbackEl.innerText = '';
            optionsContainer.innerHTML = '';

            if (currentQuestionIndex >= TOTAL_QUESTIONS) {
                showResults();
                return;
            }

            // Buat soal baru secara dinamis
            currentGeneratedQuestion = generateQuestion();

            questionNumberEl.innerText = currentQuestionIndex + 1;
            questionTextEl.innerHTML = currentGeneratedQuestion.question; // Gunakan innerHTML jika ada backticks
            
            const progressPercent = ((currentQuestionIndex + 1) / TOTAL_QUESTIONS) * 100;
            progressBar.style.width = `${progressPercent}%`;

            currentGeneratedQuestion.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.innerHTML = option; // Gunakan innerHTML jika ada backticks
                button.className = "option-btn w-full bg-gray-700 p-4 rounded-lg text-lg text-left hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200 disabled:opacity-70 disabled:hover:bg-gray-700";
                button.dataset.index = index;
                button.addEventListener('click', () => selectAnswer(button, index));
                optionsContainer.appendChild(button);
            });
        }

        function selectAnswer(button, index) {
            if (selectedAnswer !== null) return;

            selectedAnswer = index;
            // Gunakan data soal yang sudah digenerate
            const correctAnswer = currentGeneratedQuestion.answer;

            Array.from(optionsContainer.children).forEach(btn => {
                btn.disabled = true;
            });

            if (index === correctAnswer) {
                score += 10;
                scoreEl.innerText = score;
                button.classList.add('correct-answer');
                feedbackEl.innerText = "Benar! üëç";
                feedbackEl.className = "text-lg font-semibold mt-5 text-center h-8 text-green-400";
            } else {
                button.classList.add('wrong-answer');
                optionsContainer.children[correctAnswer].classList.add('correct-answer');
                feedbackEl.innerText = "Salah! üò¢ Jawaban yang benar ditandai hijau.";
                feedbackEl.className = "text-lg font-semibold mt-5 text-center h-8 text-red-400";
            }

            nextBtn.classList.remove('hidden');
        }

        function nextQuestion() {
            currentQuestionIndex++;
            loadQuestion();
        }

        function showResults() {
            quizScreen.classList.add('hidden');
            resultsScreen.classList.remove('hidden');

            const correctAnswers = score / 10;
            finalScoreEl.innerText = score;
            correctCountEl.innerText = correctAnswers;
            totalCountEl.innerText = TOTAL_QUESTIONS;

            const percentage = (correctAnswers / TOTAL_QUESTIONS) * 100;
            if (percentage === 100) {
                resultMessageEl.innerText = "Sempurna! Kamu master aljabar! üèÜ";
            } else if (percentage >= 75) {
                resultMessageEl.innerText = "Kerja bagus! Pemahamanmu sudah sangat baik! ‚ú®";
            } else if (percentage >= 50) {
                resultMessageEl.innerText = "Lumayan! Terus berlatih lagi ya! üëç";
            } else {
                resultMessageEl.innerText = "Jangan menyerah! Coba pelajari lagi materinya. üòä";
            }
        }

        function restartGame() {
            startGame();
        }

        // --- 6. EVENT LISTENERS ---
        startBtn.addEventListener('click', startGame);
        nextBtn.addEventListener('click', nextQuestion);
        restartBtn.addEventListener('click', restartGame);

    </script>
</body>

</html>
